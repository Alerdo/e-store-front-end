1-Fix the isAuthenticated Function
2- req.user is not assiging value apperantly, so check the pssport.js , the problem should be there 

First Problem 

Add to cart 

Expected on db 
cart_id , product_id , quantity
Check the router:


CORS setup 


Certainly, here are some key points you can note down for solving similar problems in the future:

Backend: CORS & Session Setup
CORS: Make sure you configure CORS correctly in your backend. If your frontend is running on http://localhost:3000, then your CORS setup can specifically allow this origin.

javascript
Copy code
const corsOptions = {
  origin: 'http://localhost:3000',
  credentials: true,
};
app.use(cors(corsOptions));
Session: Use express-session for handling sessions, and make sure to enable the cookie settings appropriately. If you're running on HTTPS in production, make the cookie secure.

javascript
Copy code
app.use(
  session({
    secret: 'your-secret-key',
    resave: false,
    saveUninitialized: false,
    cookie: {
      secure: false, // Set to true if using HTTPS
      maxAge: 24 * 60 * 60 * 1000, // 24 hours
    },
  })
);
Passport: In your Passport setup, ensure that serialization and deserialization of the user are done correctly.

javascript
Copy code
passport.serializeUser((user, done) => {
  done(null, user.id);
});
passport.deserializeUser((id, done) => {
  // Fetch user by ID
  done(null, user);
});
Frontend: Fetch/Axios Request Setup
Credentials: When making fetch or Axios requests, make sure to include credentials. This is crucial for cookies to be sent and received across origins.

javascript
Copy code
fetch(url, {
  method: 'POST',
  credentials: 'include', // Important
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(data),
});
Content-Type: Always set the Content-Type header to application/json when sending JSON data.

Debugging
Logs: Console logs are your friend. Insert log statements at key points to track the flow of data.
HTTP Status Codes: Make use of meaningful HTTP status codes in your API responses to easily identify the type of error.
Save these key points and refer back to them when you encounter similar issues in the future.



Problem: 
Cart items only fetches the product_id and not the product information, 
To achive that we perfom a join operation using sequlize. 


Problem: 
req.login wont work on the /register route, 
the user gets registred but not loged in. 
Solution:
To solve this I added 2 requests on the register front end request. 
1 to register, and depending on the data another one to log in the user. 




I know have to verify the 

PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku apps
=== alerdo23@gmail.com Apps
e-store-backendd

PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> 
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku domains -a e-store-backendd
=== e-store-backendd Heroku Domain

e-store-backendd-16f7136900ad.herokuapp.com
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku domains:add api.alerdo-ballabani.co.uk -a e-store-backendd
Configure your app's DNS provider to point to the DNS Target enigmatic-fjord-fgx1zv94s8ve7jbwfl3vigod.herokudns.com.
    For help, see https://devcenter.heroku.com/articles/custom-domains

The domain api.alerdo-ballabani.co.uk has been enqueued for addition
The domain api.alerdo-ballabani.co.uk has been enqueued for addition
Run heroku domains:wait 'api.alerdo-ballabani.co.uk' to wait for completion
Adding api.alerdo-ballabani.co.uk to ⬢ e-store-backendd... done
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend>
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku domains -a e-store-backendd
=== e-store-backendd Heroku Domain

e-store-backendd-16f7136900ad.herokuapp.com

=== e-store-backendd Custom Domains

 Domain Name                DNS Record Type DNS Target                                             SNI Endpoint 
 ────────────────────────── ─────────────── ────────────────────────────────────────────────────── ──────────── 
 api.alerdo-ballabani.co.uk CNAME           enigmatic-fjord-fgx1zv94s8ve7jbwfl3vigod.herokudns.com undefined
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku domains:wait 'api.alerdo-ballabani.co.uk' -a e-store-backendd
Waiting for api.alerdo-ballabani.co.uk... done
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku certs:auto -a e-store-backendd
=== Automatic Certificate Management is disabled on e-store-backendd
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku certs:auto:refresh -a e-store-backendd
Refreshing Automatic Certificate Management... !
 !    Your app needs ACM enabled to refresh
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> 
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku certs:auto:enable -a e-store-backendd
Enabling Automatic Certificate Management... starting. See status with heroku certs:auto or wait until active with heroku certs:auto --wait
=== Your certificate will now be managed by Heroku.  Check the status by running heroku certs:auto.
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> 
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> heroku certs:auto -a e-store-backendd
=== Automatic Certificate Management is enabled on e-store-backendd

Certificate details:
Common Name(s): api.alerdo-ballabani.co.uk
Domain(s):      735c0d67-27a6-4b3a-a5ea-0c18920a627a
Expires At:     2024-02-02 15:20 UTC
Issuer:         /CN=R3/O=Let's Encrypt/C=US
Starts At:      2023-11-04 15:20 UTC
Subject:        /CN=api.alerdo-ballabani.co.uk
SSL certificate is verified by a root authority.

Domain                      Status       Last Updated
──────────────────────────  ───────────  ──────────────────
api.alerdo-ballabani.co.uk  Cert issued  less than a minute
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend> 
PS C:\Users\alerd\OneDrive\Documents\DevelopmentFolder\E-Commerce REST API\backend>